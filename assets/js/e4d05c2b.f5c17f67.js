(window.webpackJsonp=window.webpackJsonp||[]).push([[597,441],{57:function(e,t,o){"use strict";o.r(t),o.d(t,"frontMatter",(function(){return c})),o.d(t,"metadata",(function(){return u})),o.d(t,"toc",(function(){return p})),o.d(t,"CodeSample",(function(){return d})),o.d(t,"default",(function(){return b}));var n=o(3),a=o(7),r=o(0),l=o.n(r),i=o(749),s=o(752),c={},u={unversionedId:"CodeSample",id:"version-v4/CodeSample",isDocsHomePage:!1,title:"CodeSample",description:"const [content, setContent] = useState('')",source:"@site/versioned_docs/version-v4/CodeSample.mdx",slug:"/CodeSample",permalink:"/platform/CodeSample",editUrl:"https://github.com/danchanka/platform/edit/master/versioned_docs/version-v4/CodeSample.mdx",version:"v4"},p=[],d=function(e){var t=e.url,o=e.lines,n=Object(r.useState)(""),a=n[0],c=n[1];return Object(r.useEffect)((function(){fetch(t).then((function(e){return e.text()})).then((function(e){return c(e)}))}),[t,c]),a?o?Object(i.b)(l.a.Fragment,null,Object(i.b)(s.a,{className:"lsf",metastring:o,mdxType:"CodeBlock"},a),Object(i.b)("br",null)):Object(i.b)(l.a.Fragment,null,Object(i.b)(s.a,{className:"lsf",mdxType:"CodeBlock"},a),Object(i.b)("br",null)):Object(i.b)(s.a,{className:"lsf",mdxType:"CodeBlock"},"loading...")},m={toc:p,CodeSample:d};function b(e){var t=e.components,o=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},m,o,{components:t,mdxType:"MDXLayout"}))}b.isMDXComponent=!0},669:function(e,t,o){"use strict";o.r(t),o.d(t,"frontMatter",(function(){return i})),o.d(t,"metadata",(function(){return s})),o.d(t,"toc",(function(){return c})),o.d(t,"default",(function(){return p}));var n=o(3),a=o(7),r=(o(0),o(749)),l=o(57),i={title:"How-to: GROUP SUM"},s={unversionedId:"How-to_GROUP_SUM",id:"version-v4/How-to_GROUP_SUM",isDocsHomePage:!1,title:"How-to: GROUP SUM",description:"Example 1",source:"@site/versioned_docs/version-v4/How-to_GROUP_SUM.md",slug:"/How-to_GROUP_SUM",permalink:"/platform/How-to_GROUP_SUM",editUrl:"https://github.com/danchanka/platform/edit/master/versioned_docs/version-v4/How-to_GROUP_SUM.md",version:"v4",sidebar:"version-v4/learn",previous:{title:"How-to: Computations: Overview",permalink:"/platform/How-to_Computations"},next:{title:"How-to: GROUP MAX/MIN/AGGR",permalink:"/platform/How-to_GROUP_MAX_MIN_AGGR"}},c=[{value:"Example 1",id:"example-1",children:[{value:"Condition",id:"condition",children:[]},{value:"Solution",id:"solution",children:[]}]},{value:"Example 2",id:"example-2",children:[{value:"Condition",id:"condition-1",children:[]},{value:"Solution",id:"solution-1",children:[]}]},{value:"Example 3",id:"example-3",children:[{value:"Condition",id:"condition-2",children:[]},{value:"Solution",id:"solution-2",children:[]}]},{value:"Example 4",id:"example-4",children:[{value:"Condition",id:"condition-3",children:[]},{value:"Solution",id:"solution-3",children:[]}]},{value:"Example 5",id:"example-5",children:[{value:"Condition",id:"condition-4",children:[]},{value:"Solution",id:"solution-4",children:[]}]}],u={toc:c};function p(e){var t=e.components,o=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},u,o,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"example-1"},"Example 1"),Object(r.b)("h3",{id:"condition"},"Condition"),Object(r.b)("p",null,"We have a set of books associated with certain category."),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=sample1",mdxType:"CodeSample"}),Object(r.b)("p",null,"We need to calculate the number of books in the category."),Object(r.b)("h3",{id:"solution"},"Solution"),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=solution1",mdxType:"CodeSample"}),Object(r.b)("h2",{id:"example-2"},"Example 2"),Object(r.b)("h3",{id:"condition-1"},"Condition"),Object(r.b)("p",null,"We have a set of books associated with certain tags. Each book can be associated with several tags at the same time."),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=sample2",mdxType:"CodeSample"}),Object(r.b)("p",null,"We need to calculate the number of books in the tag."),Object(r.b)("h3",{id:"solution-1"},"Solution"),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=solution2",mdxType:"CodeSample"}),Object(r.b)("h2",{id:"example-3"},"Example 3"),Object(r.b)("h3",{id:"condition-2"},"Condition"),Object(r.b)("p",null,"We have the information about the movement of books: each record is linked to the book itself and the warehouse where the movement occured, and also contains quantity and types of operations (receipt/shipment)."),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=sample3",mdxType:"CodeSample"}),Object(r.b)("p",null,"We need to calculate the current balance for a book at the warehouse."),Object(r.b)("h3",{id:"solution-2"},"Solution"),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=solution3",mdxType:"CodeSample"}),Object(r.b)("p",null,"It is recommended to mark the ",Object(r.b)("strong",{parentName:"p"},"currentBalance")," property as ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",{parentName:"strong",href:"/platform/Materializations"},"MATERIALIZED")),", so that when reading the current balances, the system could take the calculated value from the ",Object(r.b)("strong",{parentName:"p"},"bookStock")," table instead of recalculating this value based on all movements. Though this will slow down the writing process (since writing each movement will require updating the current balance), the reading process will become much faster."),Object(r.b)("p",null,"Note that you do not need to define explicitly in which table to keep the ",Object(r.b)("strong",{parentName:"p"},"currentBalance")," property, since the system will use the signature to find out the most suitable table for it (in this case, this will be ",Object(r.b)("strong",{parentName:"p"},"bookStock"),")."),Object(r.b)("h2",{id:"example-4"},"Example 4"),Object(r.b)("h3",{id:"condition-3"},"Condition"),Object(r.b)("p",null,"Similar to ",Object(r.b)("strong",{parentName:"p"},"Example 3"),", except that each movement is associated with the date of movement."),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=sample4",mdxType:"CodeSample"}),Object(r.b)("p",null,"We need to calculate the current balance for a given book at the warehouse for the specific date (as of the morning, without the movements occured on that day)."),Object(r.b)("h3",{id:"solution-3"},"Solution"),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=solution4",mdxType:"CodeSample"}),Object(r.b)("p",null,'The second option is preferable. Since requests usually refer to recent dates, the server will be calculating the result "retrospectively" from the current balance, thereby analyzing fewer records.'),Object(r.b)("h2",{id:"example-5"},"Example 5"),Object(r.b)("h3",{id:"condition-4"},"Condition"),Object(r.b)("p",null,"Similar to\xa0",Object(r.b)("strong",{parentName:"p"},"Example 3"),", except that we need to calculate the current balance for a given book across all the warehouses."),Object(r.b)("h3",{id:"solution-4"},"Solution"),Object(r.b)(l.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseSum&block=solution5",mdxType:"CodeSample"}),Object(r.b)("p",null,"Unlike the current balance for all the warehouses, it is not reasonable to mark this property as MATERIALIZED if you have only few warehouses \u2014 otherwise, UPDATE CONFLICT may occur when several users try to write the movement of the same book at different warehouses simultaneously."))}p.isMDXComponent=!0},749:function(e,t,o){"use strict";o.d(t,"a",(function(){return p})),o.d(t,"b",(function(){return b}));var n=o(0),a=o.n(n);function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var c=a.a.createContext({}),u=function(e){var t=a.a.useContext(c),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},p=function(e){var t=u(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var o=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(o),m=n,b=p["".concat(l,".").concat(m)]||p[m]||d[m]||r;return o?a.a.createElement(b,i(i({ref:t},c),{},{components:o})):a.a.createElement(b,i({ref:t},c))}));function b(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=o.length,l=new Array(r);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var c=2;c<r;c++)l[c]=o[c];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,o)}m.displayName="MDXCreateElement"},751:function(e,t){function o(e){let t,o=[];for(let n of e.split(",").map((e=>e.trim())))if(/^-?\d+$/.test(n))o.push(parseInt(n,10));else if(t=n.match(/^(-?\d+)(-|\.\.\.?|\u2025|\u2026|\u22EF)(-?\d+)$/)){let[e,n,a,r]=t;if(n&&r){n=parseInt(n),r=parseInt(r);const e=n<r?1:-1;"-"!==a&&".."!==a&&"\u2025"!==a||(r+=e);for(let t=n;t!==r;t+=e)o.push(t)}}return o}t.default=o,e.exports=o},752:function(e,t,o){"use strict";o.d(t,"a",(function(){return P}));var n=o(3),a=o(0),r=o.n(a),l=o(753),i={plain:{backgroundColor:"#2a2734",color:"#9a86fd"},styles:[{types:["comment","prolog","doctype","cdata","punctuation"],style:{color:"#6c6783"}},{types:["namespace"],style:{opacity:.7}},{types:["tag","operator","number"],style:{color:"#e09142"}},{types:["property","function"],style:{color:"#9a86fd"}},{types:["tag-id","selector","atrule-id"],style:{color:"#eeebff"}},{types:["attr-name"],style:{color:"#c4b9fe"}},{types:["boolean","string","entity","url","attr-value","keyword","control","directive","unit","statement","regex","at-rule","placeholder","variable"],style:{color:"#ffcc99"}},{types:["deleted"],style:{textDecorationLine:"line-through"}},{types:["inserted"],style:{textDecorationLine:"underline"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["important","bold"],style:{fontWeight:"bold"}},{types:["important"],style:{color:"#c4b9fe"}}]},s={Prism:o(23).a,theme:i};function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var p=/\r\n|\r|\n/,d=function(e){0===e.length?e.push({types:["plain"],content:"\n",empty:!0}):1===e.length&&""===e[0].content&&(e[0].content="\n",e[0].empty=!0)},m=function(e,t){var o=e.length;return o>0&&e[o-1]===t?e:e.concat(t)},b=function(e,t){var o=e.plain,n=Object.create(null),a=e.styles.reduce((function(e,o){var n=o.languages,a=o.style;return n&&!n.includes(t)||o.types.forEach((function(t){var o=u({},e[t],a);e[t]=o})),e}),n);return a.root=o,a.plain=u({},o,{backgroundColor:null}),a};function h(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&-1===t.indexOf(n)&&(o[n]=e[n]);return o}var y=function(e){function t(){for(var t=this,o=[],n=arguments.length;n--;)o[n]=arguments[n];e.apply(this,o),c(this,"getThemeDict",(function(e){if(void 0!==t.themeDict&&e.theme===t.prevTheme&&e.language===t.prevLanguage)return t.themeDict;t.prevTheme=e.theme,t.prevLanguage=e.language;var o=e.theme?b(e.theme,e.language):void 0;return t.themeDict=o})),c(this,"getLineProps",(function(e){var o=e.key,n=e.className,a=e.style,r=u({},h(e,["key","className","style","line"]),{className:"token-line",style:void 0,key:void 0}),l=t.getThemeDict(t.props);return void 0!==l&&(r.style=l.plain),void 0!==a&&(r.style=void 0!==r.style?u({},r.style,a):a),void 0!==o&&(r.key=o),n&&(r.className+=" "+n),r})),c(this,"getStyleForToken",(function(e){var o=e.types,n=e.empty,a=o.length,r=t.getThemeDict(t.props);if(void 0!==r){if(1===a&&"plain"===o[0])return n?{display:"inline-block"}:void 0;if(1===a&&!n)return r[o[0]];var l=n?{display:"inline-block"}:{},i=o.map((function(e){return r[e]}));return Object.assign.apply(Object,[l].concat(i))}})),c(this,"getTokenProps",(function(e){var o=e.key,n=e.className,a=e.style,r=e.token,l=u({},h(e,["key","className","style","token"]),{className:"token "+r.types.join(" "),children:r.content,style:t.getStyleForToken(r),key:void 0});return void 0!==a&&(l.style=void 0!==l.style?u({},l.style,a):a),void 0!==o&&(l.key=o),n&&(l.className+=" "+n),l})),c(this,"tokenize",(function(e,t,o,n){var a={code:t,grammar:o,language:n,tokens:[]};e.hooks.run("before-tokenize",a);var r=a.tokens=e.tokenize(a.code,a.grammar,a.language);return e.hooks.run("after-tokenize",a),r}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.Prism,o=e.language,n=e.code,a=e.children,r=this.getThemeDict(this.props),l=t.languages[o];return a({tokens:function(e){for(var t=[[]],o=[e],n=[0],a=[e.length],r=0,l=0,i=[],s=[i];l>-1;){for(;(r=n[l]++)<a[l];){var c=void 0,u=t[l],b=o[l][r];if("string"==typeof b?(u=l>0?u:["plain"],c=b):(u=m(u,b.type),b.alias&&(u=m(u,b.alias)),c=b.content),"string"==typeof c){var h=c.split(p),y=h.length;i.push({types:u,content:h[0]});for(var f=1;f<y;f++)d(i),s.push(i=[]),i.push({types:u,content:h[f]})}else l++,t.push(u),o.push(c),n.push(0),a.push(c.length)}l--,t.pop(),o.pop(),n.pop(),a.pop()}return d(i),s}(void 0!==l?this.tokenize(t,n,l,o):[n]),className:"prism-code language-"+o,style:void 0!==r?r.root:{},getLineProps:this.getLineProps,getTokenProps:this.getTokenProps})},t}(a.Component);var f=o(751),g=o.n(f),v={plain:{color:"#bfc7d5",backgroundColor:"#292d3e"},styles:[{types:["comment"],style:{color:"rgb(105, 112, 152)",fontStyle:"italic"}},{types:["string","inserted"],style:{color:"rgb(195, 232, 141)"}},{types:["number"],style:{color:"rgb(247, 140, 108)"}},{types:["builtin","char","constant","function"],style:{color:"rgb(130, 170, 255)"}},{types:["punctuation","selector"],style:{color:"rgb(199, 146, 234)"}},{types:["variable"],style:{color:"rgb(191, 199, 213)"}},{types:["class-name","attr-name"],style:{color:"rgb(255, 203, 107)"}},{types:["tag","deleted"],style:{color:"rgb(255, 85, 114)"}},{types:["operator"],style:{color:"rgb(137, 221, 255)"}},{types:["boolean"],style:{color:"rgb(255, 88, 116)"}},{types:["keyword"],style:{fontStyle:"italic"}},{types:["doctype"],style:{color:"rgb(199, 146, 234)",fontStyle:"italic"}},{types:["namespace"],style:{color:"rgb(178, 204, 214)"}},{types:["url"],style:{color:"rgb(221, 221, 221)"}}]},O=o(755),j=o(750);var k=()=>{const{prism:e}=Object(j.useThemeConfig)(),{isDarkTheme:t}=Object(O.a)(),o=e.theme||v,n=e.darkTheme||o;return t?n:o},C=o(754),S=o(58),w=o.n(S);const x=/{([\d,-]+)}/,T=(e=["js","jsBlock","jsx","python","html"])=>{const t={js:{start:"\\/\\/",end:""},jsBlock:{start:"\\/\\*",end:"\\*\\/"},jsx:{start:"\\{\\s*\\/\\*",end:"\\*\\/\\s*\\}"},python:{start:"#",end:""},html:{start:"\x3c!--",end:"--\x3e"}},o=["highlight-next-line","highlight-start","highlight-end"].join("|"),n=e.map((e=>`(?:${t[e].start}\\s*(${o})\\s*${t[e].end})`)).join("|");return new RegExp(`^\\s*(?:${n})\\s*$`)},E=/(?:title=")(.*)(?:")/;function P({children:e,className:t,metastring:o}){const{prism:i}=Object(j.useThemeConfig)(),[c,u]=Object(a.useState)(!1),[p,d]=Object(a.useState)(!1);Object(a.useEffect)((()=>{d(!0)}),[]);const m=Object(a.useRef)(null);let b=[],h="";const f=k(),v=Array.isArray(e)?e.join(""):e;if(o&&x.test(o)){const e=o.match(x)[1];b=g()(e).filter((e=>e>0))}o&&E.test(o)&&(h=o.match(E)[1]);let O=t&&t.replace(/language-/,"");!O&&i.defaultLanguage&&(O=i.defaultLanguage);let S=v.replace(/\n$/,"");if(0===b.length&&void 0!==O){let e="";const t=(e=>{switch(e){case"js":case"javascript":case"ts":case"typescript":return T(["js","jsBlock"]);case"jsx":case"tsx":return T(["js","jsBlock","jsx"]);case"html":return T(["js","jsBlock","html"]);case"python":case"py":return T(["python"]);default:return T()}})(O),o=v.replace(/\n$/,"").split("\n");let n;for(let a=0;a<o.length;){const r=a+1,l=o[a].match(t);if(null!==l){switch(l.slice(1).reduce(((e,t)=>e||t),void 0)){case"highlight-next-line":e+=`${r},`;break;case"highlight-start":n=r;break;case"highlight-end":e+=`${n}-${r-1},`}o.splice(a,1)}else a+=1}b=g()(e),S=o.join("\n")}const P=()=>{!function(e,{target:t=document.body}={}){const o=document.createElement("textarea"),n=document.activeElement;o.value=e,o.setAttribute("readonly",""),o.style.contain="strict",o.style.position="absolute",o.style.left="-9999px",o.style.fontSize="12pt";const a=document.getSelection();let r=!1;a.rangeCount>0&&(r=a.getRangeAt(0)),t.append(o),o.select(),o.selectionStart=0,o.selectionEnd=e.length;let l=!1;try{l=document.execCommand("copy")}catch{}o.remove(),r&&(a.removeAllRanges(),a.addRange(r)),n&&n.focus()}(S),u(!0),setTimeout((()=>u(!1)),2e3)};return r.a.createElement(y,Object(n.a)({},s,{key:String(p),theme:f,code:S,language:O}),(({className:e,style:t,tokens:o,getLineProps:a,getTokenProps:i})=>r.a.createElement("div",{className:w.a.codeBlockContainer},h&&r.a.createElement("div",{style:t,className:w.a.codeBlockTitle},h),r.a.createElement("div",{className:Object(l.a)(w.a.codeBlockContent,O)},r.a.createElement("div",{tabIndex:0,className:Object(l.a)(e,w.a.codeBlock,"thin-scrollbar",{[w.a.codeBlockWithTitle]:h})},r.a.createElement("div",{className:w.a.codeBlockLines,style:t},o.map(((e,t)=>{1===e.length&&""===e[0].content&&(e[0].content="\n");const o=a({line:e,key:t});return b.includes(t+1)&&(o.className=`${o.className} docusaurus-highlight-code-line`),r.a.createElement("div",Object(n.a)({key:t},o),e.map(((e,t)=>r.a.createElement("span",Object(n.a)({key:t},i({token:e,key:t}))))))})))),r.a.createElement("button",{ref:m,type:"button","aria-label":Object(C.b)({id:"theme.CodeBlock.copyButtonAriaLabel",message:"Copy code to clipboard",description:"The ARIA label for copy code blocks button"}),className:Object(l.a)(w.a.copyButton),onClick:P},c?r.a.createElement(C.a,{id:"theme.CodeBlock.copied",description:"The copied button label on code blocks"},"Copied"):r.a.createElement(C.a,{id:"theme.CodeBlock.copy",description:"The copy button label on code blocks"},"Copy"))))))}}}]);